---
title: "Make Plain Simulated Data for Smoking Visualisation"
author: "Rob Schick, PhD"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Make Plain Simulated Data for Smoking Visualisation}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

Goal of this is to simply explore making some simulated data that we can visualise with a flexidashboard.

## Data Info

The idea is to take some various geocoded locations, and add them in to a data frame. These will be master ones to be recycled. These will contain a few candidate locations like: `home`, `work`, `grocery`, `pub1`, `pub2`, etc. This will just be a starting point.

```{r}
library(smokevis)
locs1
```

Those are the raw data, and we can visualise them as follows

```{r, fig.width=8, fig.height=8}
library(leaflet)
m <- leaflet(data = locs1) %>% setView(lng = -2.9, lat = 56.403, zoom = 11)
m %>% addTiles() %>% addMarkers(lng = locs1$lng, lat = locs1$lat, popup = locs1$location)
```

Next we might imagine that we want to separate out craving events with smoking events. That might look like this:

```{r, fig.width=8, fig.height=8}
pal <- colorFactor(c("navy", "red"), domain = c("smoke", "crave"))
locs1$type <- factor(
    ifelse(runif(nrow(locs1)) > 0.75, "smoke", "crave"),
    c("smoke", "crave"))
m %>% 
  addTiles() %>%
  addCircleMarkers(
  lng = locs1$lng, lat = locs1$lat, popup = locs1$location,
    radius = ~ifelse(locs1$type == "smoke", 6, 10),
    color = ~pal(locs1$type),
    stroke = FALSE, fillOpacity = 0.5
  )
```

